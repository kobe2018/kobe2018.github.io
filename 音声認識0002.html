<!DOCTYPE html>
<html lang="ja-jp">
<head>
<title>TOEIC</title>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
 /*　画面サイズが480px以下の場合ここの記述が適用される　*/
@media screen and (max-width:600px) {
	/*　この位置に記述する　*/
	main {
    font-size:32px;
		width: 100%;
	}
}
</style>
<script>
"use strict";
let english_sample_Level1=[
{no:"1",en:`I have enough money to buy the book.`,jp:`私はその本を買うのに十分なお金を持っている。`},
{no:"8",en:`My uncle has two farms in Texas.`,jp:`私の伯父はテキサスに農場を2つ持っている。`},
{no:"13",en:`You must be hungry by now.`,jp:`もうお腹がすいているでしょう`},
{no:"19",en:`I am the father of two children.`,jp:`私は2児の父親です。`},
{no:"23",en:`They are very busy these days.`,jp:`彼らは最近とても忙しい。`},
{no:"29",en:`The bank is just around the corner.`,jp:`銀行はその角を曲がったすぐそこです。`},
{no:"34",en:`Columbus was sure that the world was round.`,jp:`コロンブスには世界は丸いという確信があった。`},
{no:"39",en:`Several of the children were afraid of the doctor.`,jp:`何人かの子どもたちはその医者を怖がっていた。`},
{no:"43",en:`Mr. Wilson has been very popular among students for years.`,jp:`ウィルソン先生は長年生徒たちの間でとても人気がある。`},
{no:"50",en:`He became ill during his trip.`,jp:`彼は旅行中に病気になった。`},
{no:"56",en:`His father's death changed him into a stronger person.`,jp:`父親の死は彼を強い人間に変えた。`},
{no:"63",en:`My grandfather died last year.`,jp:`私の祖父は去年、 他界した。`},
{no:"66",en:`Gas prices suddenly dropped last week.`,jp:`ガソリン価格が先週突然下がった。`},
{no:"71",en:`The boy almost fell off his bicycle.`,jp:`少年は自転車から落ちそうになった。`},
{no:"76",en:`Peter Pan never grows old.`,jp:`ピーター・バンは決して年をとらない。`},
{no:"79",en:`Bad things can happen, even to good people.`,jp:`悪いことというのは善良な人々の身にさえ起き得る。`},
{no:"86",en:`You must keep quiet at the library.`,jp:`図書館では静かにしていなくてはならない。`},
{no:"90",en:`A man can't live without hope.`,jp:`人は希望なしでは生きられない。`},
{no:"94",en:`I lost my blue glove at the party.`,jp:`私はそのパーティーで青い手袋をなくした。`},
{no:"98",en:`We need some more green vegetables for the salad.`,jp:`サラダに緑の野菜がもう少し必要だ。`},
{no:"105",en:`Smoke was rising from the woods.`,jp:`森から煙が立ち上っていた。`},
{no:"109",en:`The dog seemed happy with his new master.`,jp:`その犬は新しい飼い主に満足しているようだった。`},
//{no:"",en:``,jp:``},
];
const sample_const = english_sample_Level1.length;

document.addEventListener('DOMContentLoaded',function(){
  let html_string = "";
  let i = 0;
  document.getElementById("ID_div_sample_en").innerText = english_sample_Level1[i].en;
  document.getElementById("ID_div_sample_jp").innerText = english_sample_Level1[i].no +":"+ english_sample_Level1[i].jp;
  
  document.getElementById('ID_btn_voices0p3').addEventListener("click", function(){
    scriptVoice(english_sample_Level1[i].en,0.3);
  },false);

  document.getElementById('ID_btn_voices1p0').addEventListener("click", function(){
    scriptVoice(english_sample_Level1[i].en,1.0);
  },false);

  document.getElementById("ID_btn_next").addEventListener("click",function(){
    document.getElementById('ID_div_output2').innerText ="";
    if(sample_const <= i+1){
      i=0;
    }else{
      i++;
    }
    document.getElementById("ID_div_sample_en").innerText = english_sample_Level1[i].en;
    document.getElementById("ID_div_sample_jp").innerText = english_sample_Level1[i].no +":"+ english_sample_Level1[i].jp;
  },false);

  document.getElementById("ID_btn_back").addEventListener("click",function(){
    document.getElementById('ID_div_output3').innerText ="";
    if(0 == i){
      i=sample_const-1;
    }else{
      i--;
    }
    document.getElementById("ID_div_sample_en").innerText = english_sample_Level1[i].en;
    document.getElementById("ID_div_sample_jp").innerText = english_sample_Level1[i].no +":"+ english_sample_Level1[i].jp;
  },false);

  ID_btn_back

  
  document.getElementById("ID_btn_record_en").addEventListener("click",function(){  
    SpeechReco("en-US");//アメリカ英語
    //SpeechReco("ja-JP");
  },false);  
},false);//document.addEventListener('DOMContentLoaded',function(){


function SpeechReco(lang){
  let SpeechRecognition = webkitSpeechRecognition || SpeechRecognition;
  const recognition = new SpeechRecognition();
  recognition.interimResults = true; // 認識している途中にも結果を得る
  recognition.lang = lang;
      recognition.onresult = (event) => {
      //alert(event.results[0][0].transcript);
      //document.getElementById('ID_div_output').innerText = event.results[0][0].transcript;

      let count_string = event.results[0][0].transcript.split(" ").length
      console.log(event.results[0][0].transcript.split(" "),count_string)
      console.log(document.getElementById('ID_div_sample_en').innerText.split(" "))
      
      let output2="";
      for(let i=0;i<count_string;i++){
        if(event.results[0][0].transcript.split(" ")[i] == document.getElementById('ID_div_sample_en').innerText.split(" ")[i]){
          output2 += `<span style="color:green">`+event.results[0][0].transcript.split(" ")[i] + ` </span>`;
        }else{
          output2 += `<span style="color:red">`+event.results[0][0].transcript.split(" ")[i] + ` </span>`;
        }
      }
      document.getElementById('ID_div_output2').innerHTML =output2;

      if(event.results[0][0].transcript == document.getElementById('ID_div_sample_en').innerText)
        document.getElementById('ID_div_output3').innerText ="完全一致";
      }
  recognition.start();
}


function scriptVoice(speech,rate_num){
  const uttr = new SpeechSynthesisUtterance();// 発話機能をインスタンス化
  uttr.text = speech;
  uttr.lang = "en-US"; 
  //uttr.rate = 1.0;// 速度 min 0 ~ max 10
  uttr.rate = rate_num;// 速度 min 0 ~ max 10
  /*
  console.log(`Voices #: ${speechSynthesis.getVoices().length}`);
  speechSynthesis.getVoices().forEach(voice => {
    console.log(voice.name,"★", voice.lang)
  })
  */

  // 英語に対応しているvoiceを設定
  const voices = speechSynthesis.getVoices()
    for (let i = 0; i < voices.length; i++) {
      if (voices[i].lang === 'en-US') {
        uttr.voice = voices[i]
      }
    }

  window.speechSynthesis.speak(uttr);
};

</script>
</head>
<body>
<input type="button" id="ID_btn_record_en" value="英語認識">　
<input type="button" id="ID_btn_voices0p3" value="0.3">　
<input type="button" id="ID_btn_voices1p0" value="1.0発音">　
<input type="button" id="ID_btn_back" value="戻">　
<input type="button" id="ID_btn_next" value="次"><br>
<br>
<div id="ID_div_sample_en"></div>
<div id="ID_div_sample_jp"></div>
<br>
<div id="ID_div_output"></div>
<div id="ID_div_output2"></div>
<div id="ID_div_output3"></div>


</body>
</html>
<!-- 125→→→→→ -->